[gd_scene load_steps=33 format=3 uid="uid://cuqn3sg00sws4"]

[ext_resource type="Script" path="res://Scripts/Player Units/Wizard.gd" id="1_7e34a"]
[ext_resource type="Material" uid="uid://ctk2i5tsi8mmu" path="res://Material/unit.tres" id="2_ybgtr"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_b4w0m"]
animation = &"Swing"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ywqu4"]
animation = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0sf71"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2nr56"]
advance_mode = 2
advance_condition = &"is_attacking"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_picgr"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_eskig"]
states/Swing/node = SubResource("AnimationNodeAnimation_b4w0m")
states/Swing/position = Vector2(461, 18)
states/idle/node = SubResource("AnimationNodeAnimation_ywqu4")
states/idle/position = Vector2(461, 100)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_0sf71"), "idle", "Swing", SubResource("AnimationNodeStateMachineTransition_2nr56"), "Swing", "idle", SubResource("AnimationNodeStateMachineTransition_picgr")]
graph_offset = Vector2(-177, -36)

[sub_resource type="Animation" id="Animation_7pk08"]
length = 0.001

[sub_resource type="Animation" id="Animation_e12gw"]
resource_name = "Swing"
step = 0.0416667

[sub_resource type="Animation" id="Animation_jpc6a"]

[sub_resource type="Animation" id="Animation_04hpc"]
resource_name = "idle"

[sub_resource type="AnimationLibrary" id="AnimationLibrary_wq5el"]
_data = {
"RESET": SubResource("Animation_7pk08"),
"Swing": SubResource("Animation_e12gw"),
"Swing2": SubResource("Animation_jpc6a"),
"idle": SubResource("Animation_04hpc")
}

[sub_resource type="BoxMesh" id="BoxMesh_qvm5c"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_6wrj4"]
albedo_color = Color(0.419608, 0.180392, 0, 1)
metallic_specular = 0.0

[sub_resource type="SphereShape3D" id="SphereShape3D_1bes2"]
radius = 0.001

[sub_resource type="BoxShape3D" id="BoxShape3D_i76cf"]
size = Vector3(1.07789, 0.407106, 0.899353)

[sub_resource type="SphereShape3D" id="SphereShape3D_if0f0"]
radius = 1.406

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_eephl"]
transparency = 1
shading_mode = 0
albedo_color = Color(0, 0.47451, 0.796078, 1)

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_0a2so"]
particle_flag_align_y = true
direction = Vector3(0, 1, 0)
spread = 10.0
initial_velocity_min = 2.0
initial_velocity_max = 4.0
scale_min = 0.1
scale_max = 0.2

[sub_resource type="BoxMesh" id="BoxMesh_m35s7"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_t717i"]
transparency = 1
shading_mode = 0
albedo_color = Color(0, 0.603922, 0.831373, 1)

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_3k1y1"]
particle_flag_align_y = true
direction = Vector3(0, 1, 0)
spread = 10.0
initial_velocity_min = 2.5
initial_velocity_max = 5.0
scale_min = 0.03
scale_max = 0.05

[sub_resource type="BoxMesh" id="BoxMesh_nl6iv"]

[sub_resource type="LabelSettings" id="LabelSettings_3yapg"]
font_size = 40
font_color = Color(1, 1, 1, 0.333333)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_cy2da"]
bg_color = Color(0, 0, 0, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_r5v0g"]
bg_color = Color(0.847059, 0.509804, 0.0235294, 1)
border_width_left = 1
border_width_top = 1
border_width_right = 1
border_width_bottom = 1
border_color = Color(1, 1, 1, 1)

[sub_resource type="LabelSettings" id="LabelSettings_7ta6f"]
font_size = 31

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_luwjf"]
border_width_left = 2
border_width_top = 2
border_width_right = 2
border_width_bottom = 2
border_color = Color(1, 1, 1, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_5bxsv"]
bg_color = Color(1, 0.435294, 0.105882, 1)

[sub_resource type="ViewportTexture" id="ViewportTexture_36n38"]
viewport_path = NodePath("SubViewport")

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_jihjd"]
radius = 0.0654749
height = 0.348534

[node name="Wizard" type="CharacterBody3D" node_paths=PackedStringArray("wandTip", "visionSphere", "body", "attackRange", "camera", "attackCooldown", "hitDelay", "deathParticle", "hitParticle", "healthBar", "PossessedUI") groups=["Player units"]]
collision_layer = 18
collision_mask = 19
axis_lock_angular_x = true
axis_lock_angular_z = true
script = ExtResource("1_7e34a")
wandTip = NodePath("Camera3D/Area3D/CollisionShape3D")
team = 1
speed = 0.5
health = 5
visionSphere = NodePath("Area3D")
body = NodePath("CSGBox3D")
attackRange = NodePath("Area3D")
camera = NodePath("Camera3D")
knockBack = 0.0
attackCooldown = NodePath("AttackTimer")
attackCoolDowntime = 1.5
hitDelay = NodePath("hitDelay")
deathParticle = NodePath("GPUParticles3D")
hitParticle = NodePath("HitParticle")
healthBar = NodePath("SubViewport/Healthbar")
PossessedUI = NodePath("CanvasLayer")
unitType = "Wizard"

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_eskig")
anim_player = NodePath("../AnimationPlayer")
active = true
parameters/conditions/is_attacking = false

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
root_node = NodePath("../AnimationTree")
libraries = {
"": SubResource("AnimationLibrary_wq5el")
}

[node name="CSGBox3D" type="CSGBox3D" parent="."]
material_override = ExtResource("2_ybgtr")
size = Vector3(0.0993184, 0.301897, 0.099222)

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0996341, 0)
near = 0.017

[node name="CSGCylinder3D" type="CSGMesh3D" parent="Camera3D"]
transform = Transform3D(0.00767666, -0.0156672, 0.000480422, 0, 0.0153556, 0.00794174, -0.00196889, -0.061086, 0.00187316, 0.0472217, -0.0240628, -0.0964391)
mesh = SubResource("BoxMesh_qvm5c")
material = SubResource("StandardMaterial3D_6wrj4")

[node name="Area3D" type="Area3D" parent="Camera3D"]
collision_layer = 0
collision_mask = 31

[node name="CollisionShape3D" type="CollisionShape3D" parent="Camera3D/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0383835, -0.0152512, -0.130054)
shape = SubResource("SphereShape3D_1bes2")

[node name="Area3D2" type="Area3D" parent="Camera3D"]
collision_layer = 0
collision_mask = 31

[node name="CollisionShape3D" type="CollisionShape3D" parent="Camera3D/Area3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.507159)
shape = SubResource("BoxShape3D_i76cf")

[node name="Area3D" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.458144, 0.0612288)
collision_layer = 0
collision_mask = 31

[node name="CollisionShape3D" type="CollisionShape3D" parent="Area3D"]
shape = SubResource("SphereShape3D_if0f0")

[node name="AttackTimer" type="Timer" parent="."]
one_shot = true
autostart = true

[node name="hitDelay" type="Timer" parent="."]
wait_time = 0.24
one_shot = true
autostart = true

[node name="GPUParticles3D" type="GPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.202952, 0)
material_override = SubResource("StandardMaterial3D_eephl")
emitting = false
amount = 10
one_shot = true
explosiveness = 1.0
visibility_aabb = AABB(-0.456979, -1.11102, -0.539887, 0.913958, 2.00134, 1.07977)
process_material = SubResource("ParticleProcessMaterial_0a2so")
draw_pass_1 = SubResource("BoxMesh_m35s7")

[node name="HitParticle" type="GPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.202952, 0)
material_override = SubResource("StandardMaterial3D_t717i")
emitting = false
amount = 10
one_shot = true
explosiveness = 1.0
process_material = SubResource("ParticleProcessMaterial_3k1y1")
draw_pass_1 = SubResource("BoxMesh_nl6iv")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Label" type="Label" parent="CanvasLayer"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -11.5
offset_top = -29.0
offset_right = 11.5
offset_bottom = 29.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 4
text = "+"
label_settings = SubResource("LabelSettings_3yapg")
metadata/_edit_use_anchors_ = true

[node name="ProgressBar" type="ProgressBar" parent="CanvasLayer"]
anchors_preset = -1
anchor_left = 0.139
anchor_top = 0.019
anchor_right = 0.139
anchor_bottom = 0.019
offset_left = -0.128021
offset_top = -0.312001
offset_right = 299.872
offset_bottom = 38.688
theme_override_styles/background = SubResource("StyleBoxFlat_cy2da")
theme_override_styles/fill = SubResource("StyleBoxFlat_r5v0g")
value = 100.0
show_percentage = false
metadata/_edit_use_anchors_ = true

[node name="Label2" type="Label" parent="CanvasLayer"]
anchors_preset = -1
anchor_left = 0.032
anchor_top = 0.009
anchor_right = 0.032
anchor_bottom = 0.009
offset_left = 0.135998
offset_top = 0.168
offset_right = 121.136
offset_bottom = 47.168
text = "Health:"
label_settings = SubResource("LabelSettings_7ta6f")
metadata/_edit_use_anchors_ = true

[node name="SubViewport" type="SubViewport" parent="."]
disable_3d = true
transparent_bg = true

[node name="Healthbar" type="ProgressBar" parent="SubViewport"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -275.0
offset_top = -13.5
offset_right = 275.0
offset_bottom = 13.5
grow_horizontal = 2
grow_vertical = 2
size_flags_vertical = 4
theme_override_styles/background = SubResource("StyleBoxFlat_luwjf")
theme_override_styles/fill = SubResource("StyleBoxFlat_5bxsv")
value = 100.0
show_percentage = false

[node name="Sprite3D" type="Sprite3D" parent="."]
transform = Transform3D(0.05, 0, 0, 0, 0.05, 0, 0, 0, 0.05, -0.00277502, 0.343578, -0.0103018)
billboard = 1
texture = SubResource("ViewportTexture_36n38")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_jihjd")

[node name="Rays" type="Node3D" parent="."]

[node name="RayCast3D" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, 0, 0, 0, -1.31134e-08, 0.3, 0, -0.3, -1.31134e-08, 0, 0, 0)
collision_mask = 19

[node name="RayCast3D2" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, 0, 0, 0, -1.31134e-08, 0.3, 0, -0.3, -1.31134e-08, 0, 0, 0)
target_position = Vector3(0, 1, 0)
collision_mask = 19

[node name="RayCast3D3" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, 0, 0, 0, -1.31134e-08, 0.3, 0, -0.3, -1.31134e-08, 0, 0, 0)
target_position = Vector3(0.7, -0.7, 0)
collision_mask = 19

[node name="RayCast3D4" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, 0, 0, 0, -1.31134e-08, 0.3, 0, -0.3, -1.31134e-08, 0, 0, 0)
target_position = Vector3(1, 0, 0)
collision_mask = 19

[node name="RayCast3D5" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, 0, 0, 0, -1.31134e-08, 0.3, 0, -0.3, -1.31134e-08, 0, 0, 0)
target_position = Vector3(0.7, 0.7, 0)
collision_mask = 19

[node name="RayCast3D6" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, 0, 0, 0, -1.31134e-08, 0.3, 0, -0.3, -1.31134e-08, 0, 0, 0)
target_position = Vector3(-0.7, -0.7, 0)
collision_mask = 19

[node name="RayCast3D7" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, -0.000196727, 9.79803e-05, -9.79747e-05, 7.73098e-06, 0.3, -0.00019673, -0.3, 7.65971e-06, 0, 0, 0)
target_position = Vector3(-0.7, 0.7, 0)
collision_mask = 19

[node name="RayCast3D8" type="RayCast3D" parent="Rays"]
transform = Transform3D(0.3, 0, 0, 0, -1.31134e-08, 0.3, 0, -0.3, -1.31134e-08, 0, 0, 0)
target_position = Vector3(-1, 0, 0)
collision_mask = 19
